# [개념명] e-Doc 시스템 아키텍처 및 사용자 업무 플로우 - SAP 연동 기반 전자결재

## 1. 개요
SAP S/4HANA 기반 회계 전표의 결재를 웹 환경에서 수행하는 전자결재(e-Doc) 시스템으로, 파킹/포스팅 전표를 SAP와 연동하여 처리하는 구조

---

## 2. 시스템 아키텍처

### 🔧 시스템 구성
| 구성 요소 | 설명 |
|-----------|------|
| SAP (S/4HANA) | 전표 파킹/포스팅 및 전표 상태 유지 |
| e-Doc Web | Tomcat + Red Hat 기반 결재 웹 시스템 |
| e-Doc DB | MariaDB 기반 데이터 저장소 |
| e-Doc ↔ SAP 연동 | 인터페이스를 통해 전표 데이터 교환 (5분 주기) |

### 🔗 데이터 흐름
1. **SAP**에서 전표 생성 (Parked 또는 Posted)
2. 설정된 전표유형만 **e-Doc로 자동 인터페이스**
3. e-Doc에서 사용자 결재 요청 등록
4. 결재 후 승인/반려 결과가 **SAP로 전송됨**
5. Parked 전표 승인 시 → SAP에서 **자동 포스팅 처리**
6. Posted 전표 승인 시 → SAP 전표 상태는 유지됨 (단, 취소는 e-Doc에서 별도 처리)

### 🧩 시스템 환경 구성도
- **DEV / STG / PRD** 환경 분리
- e-Doc Web ↔ e-Doc DB (443, 3306 포트)
- SAP ↔ e-Doc 연동 포트 (3600/3200 등)

---

## 3. 사용자별 업무 플로우

### 👤 사용자 역할 및 흐름

```
[Finance Admin] → [일반 사용자] → [결재자(Approver)] → [결과 반영]
```

### 역할별 업무

#### 🧾 Finance Admin (재무담당자)
- SAP 전표유형 설정 (T-Code: ZUSFIV9110)
- e-Doc 마스터(문서유형, 결재선 등) 관리
- 인터페이스 대상 전표유형 지정

#### 🧑 일반 사용자
- SAP 전표 입력 (파킹 또는 포스팅)
- e-Doc에 결재 요청 등록
- 첨부파일, 설명 등 작성

#### ✅ 결재자(Approver)
- 결재 요청 문서 확인
- 승인(Approve) 또는 반려(Reject)
- 파킹 전표 승인 시 → SAP 전표 자동 포스팅
- 포스팅 전표 승인 시 → SAP 전표는 상태 유지

#### 🔁 결과 반영
- e-Doc 결재 이력 → SAP로 전송
- 반려 시 신청자에게 회신
- 포스팅 전표 반vers 등은 e-Doc에서 별도 기능 제공

---

## 4. 참고 사항
- 전표유형 설정 안 된 경우 e-Doc에 인터페이스되지 않음
- 포스팅 전표는 e-Doc 결재와 별개로 SAP 전표 상태는 그대로 유지됨
- SAP와 e-Doc 간 인터페이스는 5분 간격으로 자동 수행됨