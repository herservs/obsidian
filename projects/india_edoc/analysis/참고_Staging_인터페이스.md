# [개념명] Staging 인터페이스 - e-Doc와 SAP 연동 중계 계층

## 1. 개요
Staging 인터페이스는 SAP 시스템과 전자결재 시스템(e-Doc) 간 전표 데이터를 중계 및 전처리하기 위한 중간 계층이다. 실시간 또는 배치 방식으로 SAP 데이터를 e-Doc으로 전송하기 전 필터링, 매핑, 변환 처리를 수행한다.

## 2. 주요 역할
- SAP 시스템의 Posted / Parked 전표를 e-Doc 시스템으로 전송하기 전 **전표유형 검증**
- **인터페이스 대상 전표 선별** (T-code: `ZUSFIV9110`에서 설정)
- 데이터 **포맷 정제 및 매핑** (SAP 포맷 → e-Doc 포맷)
- 자동 전송 스케줄링 (예: **5분 간격 자동 인터페이스**)
- SAP와 e-Doc 간 **결합도 최소화** 및 **유지보수성 향상**

## 3. 구성 요소
- **SAP 측 데이터 소스**
  - Parked Document
  - Posted Document
- **Staging Layer (중계 계층)**
  - 대상 전표 필터링
  - 데이터 구조 변환
  - 승인 연동 대상 매핑
- **e-Doc 수신 시스템**
  - 결재요청 생성
  - 승인 결과 처리

## 4. 시스템 구조 내 위치
- `PRD`, `DEV`, `STG`로 분리된 구조에서 `STG`는 **Staging 시스템**을 의미
- 보통 **Red Hat / Tomcat + MariaDB 구성**의 E-Account Web/DB로 구성됨

## 5. 기술적 고려사항
- 실시간 인터페이스의 경우 WebService 또는 API 연동 고려
- 비동기 처리 시 MQ(Kafka/RabbitMQ) 연계 가능
- 전표유형 관리와 오류 로그 시스템 필요

## 6. 적용 예시
- SAP에서 생성된 전표 중 `ZUSFIV9110`에서 설정된 유형만 e-Doc 승인 대상이 됨
- 전표는 매 5분마다 자동으로 Staging 영역을 통해 e-Doc으로 전송
- 승인된 전표는 SAP로 다시 반영되지는 않으며, 취소는 별도 기능으로 수행

## 7. 확장 방안
- Staging 영역을 API 기반 EAI로 전환 가능
- Kafka 기반 로그 수집 및 모니터링 체계 추가
- SAP 이외의 다른 ERP 시스템과도 연동 확장 가능

